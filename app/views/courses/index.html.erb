<h1 class="lefttab" id="offeringsList">Available Offerings</h1>
<p>The following classes are available to you for online registration.</p>

<% @courses.each do |course| %>
	
	<div class="offering">
		<table>


			<tr>
			  <td valign="top"><%= image_tag course.image_url(:thumb) unless course.image.blank? %></td>
			  <td valign="top">
			  <%= content_tag :h2, "#{course.title} Belightful Yoga" %>
			  <%= content_tag :p, course.description %>


		 <dl class="dl-horizontal">
	   	<dt>Start date:</dt>
	   	<dd><%= course.start_date.strftime('%m/%d/%Y') %></dd>
			<dt>End date:</dt>
	   	<dd><%= course.end_date.strftime('%m/%d/%Y') %></dd>
			<dt>Time:</dt>
	   	<dd><%= "#{course.day.pluralize} #{course.start_time.strftime('%I:%M%p')} - #{course.end_time.strftime('%I:%M%p')}" %></dd>
			<dt>Price:</dt>
	   	<dd><%= number_to_currency(course.price) %></dd>	
	   </dl>	
	
		<%= content_tag :p, course.location %>
		<%= content_tag :p, course.notes %>	
		
		<% if !current_cart.nil? && !current_cart.line_items.where(:line_itemable_type => "Course").where(:line_itemable_id => course.id).empty? %>
		  <span class="label label-important">This class is already in your cart</span>
		<% else %>  
		
		<%= form_for @cart, :html => { :class => "form-inline"} do |f| %>

            <% 
            new_object = f.object.send(:line_items).klass.new
            id = new_object.object_id
            %>
            <%= f.fields_for(:line_items, new_object, child_index: id) do |line_item| %>
              <%= line_item.hidden_field :line_itemable_type, :value => "Course" %>
              <%= line_item.hidden_field :line_itemable_id, :value => course.id %>
              <%= line_item.hidden_field :qty, :value => 1 %>
            <% end %>
                <%= f.submit "Add To Cart", :class => "btn btn-primary" %>   
        <% end %>
    <% end %>


		</td></tr>
		</table>
	</div>
		
<% end %>	